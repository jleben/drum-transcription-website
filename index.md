---
---
# Drum Transcription System

Authors: Jakob Leben and Robert Van Rooyen, University of Victoria, Canada

## Overview

This software sytem provides central components for the task of transcription of
drum recordings as well as evaluation of the transcription quality. It
implements detection of drum hits in monophonic audio, transcription of detected
events into the MIDI file format, evaluation of detection by comparison with
human-provided information, and visualisation of different stages of audio
processing in the Sonic Visualiser application.

The system consists of three main software components with the following roles:
- Audio Processor: drum hit detection
- Symbolic Processor: transcription to MIDI and quality evaluation
- Sonic Visualiser plugin: audio processing visualisation

The following diagram shows the typical workflow in a drum transcription and
quality evaluation task, with blue components representing software provided
by our system, and green components external to the system. The gray parts
represent intermediate data formats:

![Graph: System Overview](images/architecture.jpg)

## Drum Hit Detection

The audio processor takes as input an audio file containing a recording of a
musical performance on drums. It analyses the audio to extract features which
allow detection of individual drum hits and their properties. Currently,
three types of sounds can be distinguished, according to source: kick drums or
tom-toms, snare drums, and hi-hats or cymbals.

The output is a list of detected drum hits with their time of occurence and
estimated drum type and strength, in form of a file in the CSV
(Comma-Separated Value) format. For example:

    0.00580499,0,0.627796
    0.272834,2,0.12992
    0.516644,2,0.141721
    0.667574,2,0.138631
    0.748844,1,0.630138
    1.00426,2,0.195278
    1.24807,2,0.143118
    1.5151,0,0.618974

## Visualisation

The Sonic Visualiser plugin provides insight into the operation of the audio
processor and allows exploration of its parameters. It re-uses the audio
processor's components to visualise the data at various stages.
Processing parameters can be tweaked and the resulting data is immediately
re-plotted.

![Sonic Visualiser Screenshot](images/sonic_vis.png)

## Transcription and Evaluation

The symbolic processor operates on information about individual drum hits.
It takes as input the output file of the audio processor and an
additional file that defines the mapping between the detected drum type and
strength values on one side and MIDI instrument numbers and note velocities on
the other side. This mapping is used to generate a MIDI file with notes
corresponding to the detected drum hits. The MIDI file can easily be loaded
into a digital audio workstation (DAW) for resynthesis.

Moreover, this program may also perform a statistical evaluation of the
success of drum hit detection, if provided another CSV or MIDI file to serve as
ground truth to compare the audio processor's output with. This can be the
result of annotation of the drum recording in a DAW. However, for highly
controlled testing of the system, it is typical to create MIDI scores first and
then synthesize them into audio to process using the system.

The result of quality evaluation is information about the accuracy, precision
and recall of drum hit detection, accuracy of drum type and hit strength
evaluation, and the confusion matrix of detected versus true events, by type.

Example evaluation output:

    Onset: A = 100.0% | P = 100.0% | R = 100.0%
    Type = 66.7%
    Strength = 66.7%
    Confusion matrix:
    ref/det       0       1       2   other  missed
          0       8       0       0       0       0
          1       0       8       0       0       0
          2       8       8      16       0       0
      other       0       0       0       0       0
      ghost       0       0       0       0

## Examples

This example demonstrates the effectiveness of the transcription system.
Below are links to the original drum recording and audio generated by
resynthesising the transcription in form of a MIDI file produced by the system.
The resynthesised version is a combination of pure resynthesised audio on the
left channel and attenuated original recording on the right channel, for live
comparison.

[Original](audio/kshtc120.wav)

[Resynthesis](audio/kshtc120_resynthesis.wav)


## Acknowledgements

The [Marsyas framework](http://marsyas.info/) is used for composition and
coordination of audio processing components in the drum hit detector and the
Sonic Visualiser plugin.

This work is a result of the Music information Retrieval course (CSC 575)
at the University of Victoria, Canada, instructed by prof. George Tzanetakis.

